<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Seb-Fit ¬∑ Creador de Rutinas</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0f172a" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    :root {
      color-scheme: dark;
      --bg: #0f172a;
      --bg-alt: #111827;
      --card: rgba(255, 255, 255, 0.06);
      --card-border: rgba(255, 255, 255, 0.12);
      --accent: #22d3ee;
      --accent-strong: #0ea5e9;
      --text: #f8fafc;
      --text-muted: #cbd5f5;
      --danger: #f87171;
      --success: #4ade80;
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, rgba(14, 116, 144, 0.25), rgba(59, 130, 246, 0.1)), var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
    }

    body.modal-open {
      overflow: hidden;
    }

    a {
      color: inherit;
    }

    .hidden {
      display: none !important;
    }

    #launch-screen {
      position: fixed;
      inset: 0;
      display: grid;
      place-items: center;
      gap: 1.5rem;
      padding: 2rem;
      background: radial-gradient(circle at top left, rgba(34, 211, 238, 0.15), transparent 45%),
        radial-gradient(circle at bottom right, rgba(59, 130, 246, 0.15), transparent 40%),
        var(--bg);
      text-align: center;
      z-index: 10;
    }

    .launch-spinner {
      width: 64px;
      height: 64px;
      border-radius: 999px;
      border: 4px solid rgba(34, 211, 238, 0.25);
      border-top-color: var(--accent);
      animation: spin 0.9s linear infinite, pulse 2.6s ease-in-out infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    @keyframes pulse {
      0%,
      100% {
        opacity: 0.55;
      }
      50% {
        opacity: 1;
      }
    }

    #app {
      position: relative;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: clamp(1.5rem, 4vw, 3rem) clamp(1.25rem, 5vw, 4rem) 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    header h1 {
      margin: 0;
      font-size: clamp(2rem, 4vw, 2.75rem);
      letter-spacing: -0.02em;
    }

    header p {
      margin: 0;
      max-width: 52ch;
      color: var(--text-muted);
      font-size: 1rem;
    }

    main {
      flex: 1;
      padding: 0 clamp(1.25rem, 5vw, 4rem) clamp(2rem, 6vw, 4rem);
      display: grid;
      gap: clamp(1.5rem, 4vw, 2.5rem);
    }

    .routine-strip {
      position: relative;
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 24px;
      padding: 1.25rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      backdrop-filter: blur(18px);
    }

    .strip-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .strip-header h2 {
      margin: 0;
      font-size: 1.15rem;
      font-weight: 700;
    }

    .strip-header span {
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .thumbnails {
      display: grid;
      gap: 0.75rem;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    }

    .thumbnail-card {
      position: relative;
      border-radius: 18px;
      overflow: hidden;
      background: rgba(15, 23, 42, 0.75);
      border: 1px solid rgba(148, 163, 184, 0.2);
      cursor: pointer;
      transition: transform 0.25s ease, box-shadow 0.25s ease;
      min-height: 140px;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
    }

    .thumbnail-card:focus-visible,
    .thumbnail-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 35px -25px rgba(14, 165, 233, 0.65);
    }

    .thumbnail-visual {
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      font-size: 2.75rem;
      opacity: 0.85;
      transition: opacity 0.25s ease;
    }

    .thumbnail-card:hover .thumbnail-visual,
    .thumbnail-card:focus-visible .thumbnail-visual {
      opacity: 1;
    }

    .thumbnail-info {
      position: relative;
      padding: 1rem;
      background: linear-gradient(180deg, transparent, rgba(15, 23, 42, 0.95));
    }

    .thumbnail-info h3 {
      margin: 0 0 0.15rem;
      font-size: 1rem;
    }

    .thumbnail-info p {
      margin: 0;
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    .thumbnail-actions {
      position: absolute;
      inset: 0.75rem 0.75rem auto auto;
      display: flex;
      gap: 0.5rem;
    }

    .thumbnail-actions button {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      border: none;
      display: grid;
      place-items: center;
      font-size: 0.95rem;
      cursor: pointer;
      transition: transform 0.2s ease, opacity 0.2s ease;
      backdrop-filter: blur(12px);
      background: rgba(15, 23, 42, 0.55);
      color: var(--text);
    }

    .thumbnail-actions button:hover,
    .thumbnail-actions button:focus-visible {
      transform: scale(1.05);
      background: rgba(14, 116, 144, 0.75);
    }

    .thumbnail-actions button[data-action="delete"] {
      background: rgba(248, 113, 113, 0.2);
      color: #fecaca;
    }

    .strip-footer {
      position: sticky;
      bottom: 0;
      display: flex;
      justify-content: flex-end;
    }

    .btn {
      border: none;
      border-radius: 999px;
      font-weight: 600;
      font-size: 0.95rem;
      padding: 0.85rem 1.75rem;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      color: #0f172a;
      box-shadow: 0 15px 25px -15px rgba(34, 211, 238, 0.65);
    }

    .btn[disabled] {
      cursor: not-allowed;
      filter: grayscale(0.4);
      opacity: 0.55;
      box-shadow: none;
    }

    .btn:hover:not([disabled]),
    .btn:focus-visible:not([disabled]) {
      transform: translateY(-2px);
      box-shadow: 0 18px 30px -18px rgba(34, 211, 238, 0.85);
    }

    .btn-secondary {
      background: rgba(148, 163, 184, 0.15);
      color: var(--text);
      box-shadow: none;
    }

    .btn-secondary:hover,
    .btn-secondary:focus-visible {
      background: rgba(148, 163, 184, 0.25);
    }

    .library {
      display: grid;
      gap: 1.25rem;
    }

    .library-list {
      display: grid;
      gap: 1rem;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    }

    .library-card {
      border-radius: 22px;
      border: 1px solid rgba(148, 163, 184, 0.15);
      background: rgba(15, 23, 42, 0.75);
      padding: 1.25rem;
      display: flex;
      flex-direction: column;
      gap: 1.1rem;
      position: relative;
      overflow: hidden;
      min-height: 220px;
      backdrop-filter: blur(12px);
    }

    .library-card::after {
      content: '';
      position: absolute;
      inset: auto -25% -35% -25%;
      height: 160px;
      background: radial-gradient(circle at center, rgba(34, 211, 238, 0.25), transparent 65%);
      opacity: 0.8;
      transform: rotate(-8deg);
      pointer-events: none;
    }

    .library-visual {
      width: 72px;
      height: 72px;
      border-radius: 20px;
      display: grid;
      place-items: center;
      font-size: 2rem;
      background: rgba(34, 211, 238, 0.18);
    }

    .library-card h3 {
      margin: 0;
      font-size: 1.15rem;
    }

    .library-card p {
      margin: 0;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .library-card footer {
      margin-top: auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
    }

    .chip {
      border-radius: 999px;
      padding: 0.4rem 0.85rem;
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      background: rgba(148, 163, 184, 0.18);
      color: var(--text-muted);
    }

    .empty-state {
      border: 1px dashed rgba(148, 163, 184, 0.35);
      border-radius: 18px;
      padding: 1.25rem;
      text-align: center;
      color: var(--text-muted);
      font-size: 0.95rem;
      background: rgba(15, 23, 42, 0.6);
    }

    .overlay {
      position: fixed;
      inset: 0;
      display: grid;
      place-items: center;
      background: rgba(4, 7, 20, 0.65);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease;
      padding: 1rem;
      z-index: 30;
    }

    .overlay.is-visible {
      opacity: 1;
      pointer-events: auto;
    }

    .bottom-sheet {
      width: min(520px, 100%);
      border-radius: 24px 24px 0 0;
      background: var(--bg-alt);
      border: 1px solid rgba(148, 163, 184, 0.2);
      padding: 1.75rem clamp(1.25rem, 5vw, 2rem) clamp(1.75rem, 6vw, 2.5rem);
      transform: translateY(100%);
      transition: transform 0.3s ease;
      position: relative;
      max-height: 90vh;
      overflow-y: auto;
    }

    .overlay.is-visible .bottom-sheet {
      transform: translateY(0);
    }

    .sheet-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .sheet-header h2 {
      margin: 0;
      font-size: 1.35rem;
    }

    .sheet-header button {
      border: none;
      background: rgba(148, 163, 184, 0.2);
      color: var(--text);
      width: 36px;
      height: 36px;
      border-radius: 999px;
      cursor: pointer;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
    }

    .field label {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .field input {
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      background: rgba(15, 23, 42, 0.8);
      padding: 0.85rem 1rem;
      color: var(--text);
      font-size: 1rem;
      font-weight: 600;
    }

    .sheet-grid {
      display: grid;
      gap: 1rem;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    }

    .sheet-actions {
      margin-top: 1.5rem;
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .timeline {
      width: min(880px, 100%);
      background: var(--bg-alt);
      border-radius: 28px;
      padding: clamp(1.5rem, 4vw, 2.5rem);
      border: 1px solid rgba(148, 163, 184, 0.2);
      box-shadow: 0 35px 55px -35px rgba(14, 165, 233, 0.45);
      display: flex;
      flex-direction: column;
      gap: 2rem;
      max-height: 90vh;
      overflow-y: auto;
      transform: translateY(30px);
      transition: transform 0.3s ease;
    }

    .overlay.is-visible .timeline {
      transform: translateY(0);
    }

    .timeline header {
      padding: 0;
    }

    .timeline-list {
      display: grid;
      gap: 1.5rem;
      position: relative;
      padding-left: 1.75rem;
    }

    .timeline-list::before {
      content: '';
      position: absolute;
      inset: 0 auto 0 0.7rem;
      width: 2px;
      background: linear-gradient(180deg, rgba(34, 211, 238, 0.6), transparent 90%);
    }

    .timeline-item {
      position: relative;
      padding: 1.15rem 1.25rem;
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.2);
      background: rgba(15, 23, 42, 0.85);
      display: grid;
      gap: 0.35rem;
    }

    .timeline-item::before {
      content: attr(data-step);
      position: absolute;
      top: 1.15rem;
      left: -1.9rem;
      width: 2.2rem;
      height: 2.2rem;
      border-radius: 999px;
      background: linear-gradient(135deg, rgba(34, 211, 238, 0.75), rgba(14, 165, 233, 0.95));
      color: #0f172a;
      font-weight: 700;
      display: grid;
      place-items: center;
      box-shadow: 0 12px 22px -16px rgba(34, 211, 238, 0.85);
    }

    .timeline-item strong {
      font-size: 1.05rem;
    }

    .timeline-item span {
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .timeline-actions {
      display: flex;
      justify-content: flex-end;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .confirmation-card {
      width: min(460px, 100%);
      background: var(--bg-alt);
      border-radius: 24px;
      padding: clamp(1.5rem, 4vw, 2.25rem);
      border: 1px solid rgba(148, 163, 184, 0.2);
      display: grid;
      gap: 1rem;
      text-align: center;
      transform: translateY(30px);
      transition: transform 0.3s ease;
      box-shadow: 0 25px 45px -25px rgba(34, 211, 238, 0.45);
    }

    .overlay.is-visible .confirmation-card {
      transform: translateY(0);
    }

    .confirmation-card h2 {
      margin: 0;
      font-size: 1.55rem;
    }

    .confirmation-card p {
      margin: 0;
      color: var(--text-muted);
      font-size: 0.95rem;
    }

    .confirmation-actions {
      display: grid;
      gap: 0.75rem;
      margin-top: 0.5rem;
    }

    .confirmation-actions .btn-secondary {
      background: rgba(79, 70, 229, 0.2);
    }

    @media (min-width: 768px) {
      .confirmation-actions {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.001ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.001ms !important;
        scroll-behavior: auto !important;
      }
    }
  </style>
</head>
<body>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js').catch(() => {});
      });
    }
  </script>

  <div id="launch-screen">
    <div>
      <div style="display:flex;justify-content:center;gap:0.75rem;align-items:center;">
        <div style="width:56px;height:56px;border-radius:20px;background:rgba(34,211,238,0.2);display:grid;place-items:center;font-size:1.75rem;">üèãÔ∏è</div>
        <div style="text-align:left;">
          <p style="margin:0;font-weight:700;font-size:0.8rem;letter-spacing:0.3em;color:var(--accent);text-transform:uppercase;">Seb-Fit</p>
          <p style="margin:0;font-weight:800;font-size:1.35rem;">Preparando tu experiencia inmersiva</p>
        </div>
      </div>
      <p style="max-width:36ch;margin:1rem auto 0;color:var(--text-muted);">
        Organizamos tus ejercicios y configuraciones para que solo tengas que enfocarte en entrenar.
      </p>
    </div>
    <div class="launch-spinner" aria-hidden="true"></div>
  </div>

  <div id="app" class="hidden" aria-live="polite">
    <header>
      <h1>Crea tu rutina magistral</h1>
      <p>
        A√±ade ejercicios, personaliza series, repeticiones, peso y descansos desde una hoja inmersiva que se desliza desde la parte inferior.
        Visualiza la l√≠nea de tiempo completa antes de guardar y decide si vinculas a un asesorado o comienzas de inmediato.
      </p>
    </header>

    <main>
      <section class="routine-strip" aria-label="Miniaturas de la rutina">
        <div class="strip-header">
          <h2>Tu flujo de ejercicios</h2>
          <span id="thumbnail-count">Sin ejercicios a√∫n</span>
        </div>
        <div id="routine-thumbnails" class="thumbnails" role="list"></div>
        <div id="empty-strip" class="empty-state">
          A√±ade ejercicios desde la biblioteca para empezar a construir tu rutina. Cada tarjeta se convierte en una mini ventana editable.
        </div>
        <div class="strip-footer">
          <button id="view-routine" class="btn" type="button" disabled>Ver rutina</button>
        </div>
      </section>

      <section class="library" aria-label="Biblioteca de ejercicios">
        <header>
          <h2 style="margin:0;font-size:1.45rem;">Biblioteca inmersiva</h2>
          <p style="margin:0;color:var(--text-muted);max-width:62ch;">
            Toca cualquier ejercicio para a√±adirlo. Se generar√° una miniatura superior lista para editar o eliminar.
          </p>
        </header>
        <div id="exercise-library" class="library-list" role="list"></div>
      </section>
    </main>
  </div>

  <div id="editor-overlay" class="overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="bottom-sheet" role="document">
      <div class="sheet-header">
        <h2 id="editor-title">Configurar ejercicio</h2>
        <button type="button" id="close-editor" aria-label="Cerrar hoja">‚úï</button>
      </div>
      <p id="editor-subtitle" style="margin-top:-0.5rem;margin-bottom:1.5rem;color:var(--text-muted);"></p>
      <form id="editor-form" class="sheet-grid">
        <div class="field">
          <label for="editor-sets">Series</label>
          <input id="editor-sets" name="sets" type="number" min="1" value="3" required />
        </div>
        <div class="field">
          <label for="editor-reps">Repeticiones</label>
          <input id="editor-reps" name="reps" type="number" min="1" value="12" required />
        </div>
        <div class="field">
          <label for="editor-weight">Peso (kg)</label>
          <input id="editor-weight" name="weight" type="number" min="0" step="0.5" value="0" />
        </div>
        <div class="field">
          <label for="editor-rest">Descanso (seg)</label>
          <input id="editor-rest" name="rest" type="number" min="0" value="60" />
        </div>
        <div class="sheet-actions">
          <button type="button" id="cancel-editor" class="btn-secondary btn">Cancelar</button>
          <button type="submit" class="btn">Guardar cambios</button>
        </div>
      </form>
    </div>
  </div>

  <div id="timeline-overlay" class="overlay" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="timeline" role="document">
      <header>
        <h2 style="margin:0;font-size:1.75rem;">L√≠nea de tiempo de la rutina</h2>
        <p style="margin:0.5rem 0 0;color:var(--text-muted);">Revisa el orden, intensidad y descansos antes de guardar.</p>
      </header>
      <div id="timeline-list" class="timeline-list"></div>
      <div class="timeline-actions">
        <button type="button" id="close-timeline" class="btn-secondary btn">Seguir editando</button>
        <button type="button" id="save-routine" class="btn">Guardar rutina</button>
      </div>
    </div>
  </div>

  <div id="confirmation-overlay" class="overlay" aria-hidden="true" role="alertdialog" aria-modal="true">
    <div class="confirmation-card" role="document">
      <h2>¬°Rutina creada con √©xito!</h2>
      <p>Tu secuencia qued√≥ guardada. ¬øCu√°l es tu siguiente paso?</p>
      <div class="confirmation-actions">
        <button type="button" class="btn-secondary btn" id="link-routine">Vincular rutina a asesorado</button>
        <button type="button" class="btn" id="start-routine">Comenzar rutina</button>
      </div>
      <button type="button" class="btn-secondary btn" id="close-confirmation" style="margin-top:0.5rem;">Cerrar</button>
    </div>
  </div>

  <script type="module" src="./app.js"></script>
</body>
</html>
